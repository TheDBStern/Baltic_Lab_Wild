# snp annotation pipeline

# SNP file should be in the format "Scaffold\tPosition" with no header, and sorted by scaffold and position
# to sort in R
df <- df[order(df[,1],df[,2]),]

#turn into a bed file for BEDOPS
python snps_to_regions.soft_around.py -i BalticWild_BalticPops_sig_snps.txt -o BalticWild_BalticPops_sig_snps.2snps.bed -w 2 -n 1

# run BEDOPS to get closest gene to each SNP
sort-bed BalticWild_BalticPops_sig_snps.2snps.bed > BalticWild_BalticPops_sig_snps.2snps.sorted.bed
closest-features --ec --closest --dist BalticWild_BalticPops_sig_snps.2snps.sorted.bed EAFF.merged.stranded.filtered.v2.sorted.merged.sorted.fix.bed > BalticWild_BalticPops_sig_snps.2snps.sorted.closest.marijan.bed

# Rearrange the output file so it is in the format "Scaffold\tPosition\tgene_name\tdistance"
# I just use find & replace in textwrangler to remove unneeded info
# When no gene_name entry, use the oId 
# The python script above creates 2 positions for each SNP. The true position is the one between those two.


# in R::dplyr, merge that file with the descriptive annotations
